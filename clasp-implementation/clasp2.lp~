label_prob("object7",p,351).
label_prob("object7",trn,2060).
label_prob("object7",sg,2607).
label_prob("object7",sk,3421).
label_prob("object7",tr,3822).
label_prob("object7",si,4468).
label_prob("object7",c,4492).
label_prob("object7",wi,5082).
label_prob("object7",b,5402).
label_prob("object7",d,5574).
label_prob("object7",st,5941).
label_prob("object7",wh,6850).
label_prob("object15",c,1134).
label_prob("object15",sg,1634).
label_prob("object15",wi,1764).
label_prob("object15",wh,1919).
label_prob("object15",st,2868).
label_prob("object15",d,2939).
label_prob("object15",trn,3765).
label_prob("object15",b,4194).
label_prob("object15",sk,5072).
label_prob("object15",si,5424).
label_prob("object15",tr,5449).
label_prob("object15",p,6085).
label_prob("object5",sg,798).
label_prob("object5",trn,1460).
label_prob("object5",si,1925).
label_prob("object5",d,2179).
label_prob("object5",wi,3573).
label_prob("object5",c,4347).
label_prob("object5",st,4697).
label_prob("object5",wh,5416).
label_prob("object5",p,5932).
label_prob("object5",tr,6738).
label_prob("object5",sk,7458).
label_prob("object5",b,8401).
label_prob("object16",wi,766).
label_prob("object16",wh,995).
label_prob("object16",trn,3162).
label_prob("object16",d,3673).
label_prob("object16",sg,3880).
label_prob("object16",c,3998).
label_prob("object16",p,4005).
label_prob("object16",si,4136).
label_prob("object16",sk,4622).
label_prob("object16",st,4675).
label_prob("object16",tr,5588).
label_prob("object16",b,6099).
label_prob("object1",b,1235).
label_prob("object1",st,1240).
label_prob("object1",tr,1243).
label_prob("object1",sk,2029).
label_prob("object1",si,20920).
label_prob("object1",wi,32152).
label_prob("object1",p,35219).
label_prob("object1",sg,44213).
label_prob("object1",c,46093).
label_prob("object1",d,48178).
label_prob("object1",wh,58658).
label_prob("object1",trn,73308).
label_prob("object6",c,186).
label_prob("object6",tr,2500).
label_prob("object6",b,3253).
label_prob("object6",st,3566).
label_prob("object6",wi,4561).
label_prob("object6",sk,4742).
label_prob("object6",p,6144).
label_prob("object6",d,9630).
label_prob("object6",sg,9687).
label_prob("object6",si,10047).
label_prob("object6",trn,14834).
label_prob("object6",wh,17853).
label_prob("object4",tr,746).
label_prob("object4",si,747).
label_prob("object4",sk,2956).
label_prob("object4",b,9140).
label_prob("object4",d,11036).
label_prob("object4",st,12665).
label_prob("object4",sg,13920).
label_prob("object4",p,15313).
label_prob("object4",trn,16462).
label_prob("object4",c,18332).
label_prob("object4",wh,21337).
label_prob("object4",wi,22688).
label_prob("object2",wi,195).
label_prob("object2",d,3006).
label_prob("object2",trn,3394).
label_prob("object2",st,3880).
label_prob("object2",sg,4010).
label_prob("object2",wh,4099).
label_prob("object2",b,4351).
label_prob("object2",sk,4710).
label_prob("object2",si,4822).
label_prob("object2",p,5030).
label_prob("object2",tr,6089).
label_prob("object2",c,7270).
label_prob("object12",si,150).
label_prob("object12",trn,2024).
label_prob("object12",st,5989).
label_prob("object12",b,6329).
label_prob("object12",wi,6666).
label_prob("object12",tr,6943).
label_prob("object12",sk,7510).
label_prob("object12",sg,8366).
label_prob("object12",c,8846).
label_prob("object12",d,9462).
label_prob("object12",wh,10161).
label_prob("object12",p,10770).
label_prob("object11",wi,404).
label_prob("object11",wh,2365).
label_prob("object11",p,2640).
label_prob("object11",trn,3158).
label_prob("object11",c,3195).
label_prob("object11",d,3715).
label_prob("object11",sk,3834).
label_prob("object11",sg,4171).
label_prob("object11",si,4582).
label_prob("object11",st,4925).
label_prob("object11",tr,5588).
label_prob("object11",b,6701).
label_prob("object8",wi,841).
label_prob("object8",d,1680).
label_prob("object8",wh,2118).
label_prob("object8",p,2521).
label_prob("object8",trn,2529).
label_prob("object8",c,3467).
label_prob("object8",sg,3555).
label_prob("object8",st,4325).
label_prob("object8",si,4384).
label_prob("object8",sk,4614).
label_prob("object8",tr,5511).
label_prob("object8",b,5862).
label_prob("object10",c,149).
label_prob("object10",si,2685).
label_prob("object10",wh,3477).
label_prob("object10",p,3932).
label_prob("object10",st,5080).
label_prob("object10",b,5106).
label_prob("object10",sk,5180).
label_prob("object10",tr,6315).
label_prob("object10",d,8703).
label_prob("object10",sg,9208).
label_prob("object10",trn,9586).
label_prob("object10",wi,14846).
label_prob("object3",st,577).
label_prob("object3",sk,1101).
label_prob("object3",si,2239).
label_prob("object3",tr,10231).
label_prob("object3",sg,11256).
label_prob("object3",c,11979).
label_prob("object3",p,13661).
label_prob("object3",d,15180).
label_prob("object3",wh,15326).
label_prob("object3",trn,16087).
label_prob("object3",wi,18396).
label_prob("object3",b,20623).
label_prob("object9",wh,852).
label_prob("object9",wi,1187).
label_prob("object9",p,2685).
label_prob("object9",d,2728).
label_prob("object9",trn,2985).
label_prob("object9",c,3538).
label_prob("object9",sg,4030).
label_prob("object9",si,4060).
label_prob("object9",sk,4872).
label_prob("object9",st,5104).
label_prob("object9",tr,5619).
label_prob("object9",b,5723).
label_prob("object14",wh,363).
label_prob("object14",wi,1926).
label_prob("object14",c,2197).
label_prob("object14",sg,4554).
label_prob("object14",trn,4674).
label_prob("object14",p,5041).
label_prob("object14",st,5197).
label_prob("object14",d,5229).
label_prob("object14",sk,5417).
label_prob("object14",si,5682).
label_prob("object14",tr,6230).
label_prob("object14",b,6916).
label_prob("object13",wi,548).
label_prob("object13",p,2198).
label_prob("object13",trn,2514).
label_prob("object13",d,2625).
label_prob("object13",wh,2873).
label_prob("object13",c,3233).
label_prob("object13",si,3615).
label_prob("object13",st,4314).
label_prob("object13",sk,4631).
label_prob("object13",sg,5323).
label_prob("object13",tr,5357).
label_prob("object13",b,6062).

contains("object6","object7").
contains("object10","object15").
contains("object4","object5").
contains("object6","object16").
contains("object1","object2").
contains("object1","object11").
contains("object6","object11").
contains("object1","object8").
contains("object6","object9").
contains("object10","object14").
contains("object1","object13").
contains("object10","object13").

higher("object15","object7").
higher("object5","object7").
higher("object1","object7").
higher("object6","object7").
higher("object4","object7").
higher("object2","object7").
higher("object12","object7").
higher("object11","object7").
higher("object8","object7").
higher("object10","object7").
higher("object3","object7").
higher("object9","object7").
higher("object14","object7").
higher("object13","object7").
higher("object5","object15").
higher("object1","object15").
higher("object4","object15").
higher("object2","object15").
higher("object12","object15").
higher("object8","object15").
higher("object10","object15").
higher("object3","object15").
higher("object14","object15").
higher("object13","object15").
higher("object1","object5").
higher("object4","object5").
higher("object12","object5").
higher("object7","object16").
higher("object15","object16").
higher("object5","object16").
higher("object1","object16").
higher("object6","object16").
higher("object4","object16").
higher("object2","object16").
higher("object12","object16").
higher("object11","object16").
higher("object8","object16").
higher("object10","object16").
higher("object3","object16").
higher("object9","object16").
higher("object14","object16").
higher("object13","object16").
higher("object15","object6").
higher("object5","object6").
higher("object1","object6").
higher("object4","object6").
higher("object2","object6").
higher("object12","object6").
higher("object8","object6").
higher("object10","object6").
higher("object3","object6").
higher("object14","object6").
higher("object13","object6").
higher("object1","object4").
higher("object5","object2").
higher("object1","object2").
higher("object4","object2").
higher("object12","object2").
higher("object8","object2").
higher("object10","object2").
higher("object3","object2").
higher("object1","object12").
higher("object4","object12").
higher("object15","object11").
higher("object5","object11").
higher("object1","object11").
higher("object6","object11").
higher("object4","object11").
higher("object2","object11").
higher("object12","object11").
higher("object8","object11").
higher("object10","object11").
higher("object3","object11").
higher("object14","object11").
higher("object13","object11").
higher("object5","object8").
higher("object1","object8").
higher("object4","object8").
higher("object12","object8").
higher("object3","object8").
higher("object5","object10").
higher("object1","object10").
higher("object4","object10").
higher("object12","object10").
higher("object8","object10").
higher("object3","object10").
higher("object5","object3").
higher("object1","object3").
higher("object4","object3").
higher("object12","object3").
higher("object15","object9").
higher("object5","object9").
higher("object1","object9").
higher("object6","object9").
higher("object4","object9").
higher("object2","object9").
higher("object12","object9").
higher("object11","object9").
higher("object8","object9").
higher("object10","object9").
higher("object3","object9").
higher("object14","object9").
higher("object13","object9").
higher("object5","object14").
higher("object1","object14").
higher("object4","object14").
higher("object2","object14").
higher("object12","object14").
higher("object8","object14").
higher("object10","object14").
higher("object3","object14").
higher("object5","object13").
higher("object1","object13").
higher("object4","object13").
higher("object2","object13").
higher("object12","object13").
higher("object8","object13").
higher("object10","object13").
higher("object3","object13").
higher("object14","object13").

small_object(wh).
small_object(wi).
car_part(wh).
car_part(wi).
large_object(b).
large_object(tr).


assigned_label_prob(X,L,P) :- label_prob(X,L,P), not n_assigned_label_prob(X,L,P).
n_assigned_label_prob(X,L,P) :- label_prob(X,L,P), not assigned_label_prob(X,L,P).

:- #count{L : assigned_label_prob(X,L,P)} != 1, object(X).

:~ assigned_label_prob(X,L,P). [P@1,X,L]



%%% CONTAINMENT CONSTRAINTS %%%

% a window is contained in a car or a building:

:~ assigned_label(X,wi), not in_window_position(X). [230@1,X]
in_window_position(X2) :- contains(X1,X2), assigned_label(X1,c).
in_window_position(X2) :- contains(X1,X2), assigned_label(X1,b).


% a wheel is contained in a car:

:~ assigned_label(X,wh), not in_wheel_position(X). [230@1,X]
in_wheel_position(X2) :- contains(X1,X2), assigned_label(X1,c).


% a trunk is part of a tree:

:~ assigned_label(X,trn), not in_trunk_position(X). [230@1,X]
:~ not assigned_label(X,trn), in_trunk_position(X). [230@1,X]
in_trunk_position(X2) :- contains(X1,X2), assigned_label(X1,tr).


% a car contains a carpart:

:~ assigned_label(X,c), not contains_car_part(X). [230@1,X]
contains_car_part(X1) :- contains(X1,X2), assigned_label(X2,L), car_part(L).


%%% NUMBER CONSTRAINTS %%%

% there is at most one sky:

:~ assigned_label(X1,sk), assigned_label(X2,sk), X1 != X2. [230@1,X1,X2]


%%% SIZE CONSTRAINTS %%%

:~ higher(X1,X2), assigned_label(X1,L1), assigned_label(X2,L2), small_object(L1), large_object(L2), X1 != X2. [230@1,X1,X2,L1,L2]


scene("000021").
object("object7").
object("object15").
object("object5").
object("object16").
object("object1").
object("object6").
object("object4").
object("object2").
object("object12").
object("object11").
object("object8").
object("object10").
object("object3").
object("object9").
object("object14").
object("object13").
label(0,sg).
label_string("sg",sg).
label(1,p).
label_string("p",p).
label(2,tr).
label_string("tr",tr).
label(3,wi).
label_string("wi",wi).
label(4,d).
label_string("d",d).
label(5,st).
label_string("st",st).
label(6,c).
label_string("c",c).
label(7,sk).
label_string("sk",sk).
label(8,b).
label_string("b",b).
label(9,si).
label_string("si",si).
label(10,wh).
label_string("wh",wh).
label(11,trn).
label_string("trn",trn).

assigned_label(X,L) :- assigned_label_prob(X,L,P).

